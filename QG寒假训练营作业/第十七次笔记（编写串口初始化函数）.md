**第十七次笔记（编写串口初始化函数）**

*波特率计算*：根据晶振频率，目标波特率，计算定时器T1的重装值计算

波特率 = (2^SMOD) × 晶振频率 / (12 × 32 × (256 - TH1))（不用背，套用）

TH1 = 256 - (2^SMOD) × 晶振频率 / (12 × 32 × 波特率)

**51单片机配置步骤**

1:先写宏定义（#define）

2：配置串口工作模式（SCON寄存器模式，同时初始化一下）

3：配置定时器T1作为波特率发生器（先清空T1模式位再配置）

4：设置T1重装值（决定波特率，与晶振匹配）+关闭T1中断（T1用作波特率发射器，不用中断）

5：启动T1定时器

6：编写发送功能（字符写入缓冲区，手动清0）

7:主函数调用初始化+循环发送验证

**波特率误差常见原因**

1：晶振频率与 TH1 重装值不匹配

2：定时器 T1 模式配置错误

3：SMOD 位（波特率加倍位）误操作

4. T1 未启动 / 中断干扰
5. 仿真/硬件配置有误
第十五次笔记（定时器 + 按键 + LED + 数码管联动）

**经验**：一个变量应该只有一个明确的职责。不应该让一个变量做很多的事，比如刚开始我写的，a既判断位数又参与扫描

if函数条件判断没有连续

注意if 和else if，扫描时用到

**消影**// 正确的消影顺序
P2 = 0xFF;  // 1. 先关闭所有数码管（消影）
P0 = 0x00;  // 2. 清除段码
delay_us(10);  // 3. 短暂延时（可选）
P0 = 新段码;  // 4. 设置新段码
P2 = 位选码;  // 5. 最后打开位选



条件判断

// 遇到的经典问题
if(a==0) { a=1; }  // 执行后a变成1
if(a==1) { a=0; }  // 这个也会执行！

// 正确：使用else if
if(a==0) { a=1; }
else if(a==1) { a=0; }  // 只有上一个不成立才检查

理清逻辑流程，理解`if`和`else if`的区别。

对于扫描

// 你的需求：暂停时"静止显示"
// 实际上：动态扫描不能停，只是内容不变

void interrupt() {
    // 这个扫描循环永远不能停！
    if(scan_flag==0) 显示十位();
    else 显示个位();
    scan_flag = !scan_flag;
    

    if(运行状态) 更新数字();
    // 暂停时：仍然扫描，但不更新数字
}